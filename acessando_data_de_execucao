from airflow.operators.bash import BashOperator

my_task = BashOperator(
    task_id='my_task',
    bash_command='echo "The execution date is {{ ds }}"',
)

from airflow.operators.python import PythonOperator

def my_function(execution_date, **context):
    # Now you can use execution_date as a normal Python variable
    return execution_date

my_python_task = PythonOperator(
    task_id='my_python_task',
    python_callable=my_function,
    provide_context=True,
)

def pull_execution_date(**context):
    # Retrieve the execution date from XCom
    execution_date = context['task_instance'].xcom_pull(task_ids='push_execution_date')
    print(f"Pulled execution date: {execution_date}")

pull_task = PythonOperator(
    task_id='pull_execution_date',
    python_callable=pull_execution_date,
    provide_context=True,
)

('DateTime' object has no attribute '__name__'; 43971)

def push_execution_date(execution_date, **context):
    # Convert the execution date to a string and return
    return execution_date.strftime("%Y-%m-%d")

Convertendo pra string a data

@task(task_id="salesforce")
    def salesforce_query():
        
        python_callable=sf_api_util.execute_query("SELECT * FROM CXP_Account_Name__c")
